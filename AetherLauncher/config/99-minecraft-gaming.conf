# Configurações de Kernel para Minecraft Performance EXTREMA no Linux
# Copiar para /etc/sysctl.d/99-minecraft-gaming.conf e executar: sudo sysctl -p

# ============================================================================
# OTIMIZAÇÕES DE REDE (Para Multiplayer)
# ============================================================================
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.core.rmem_default = 131072
net.core.wmem_default = 131072
net.core.netdev_max_backlog = 5000
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.tcp_fastopen = 3
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_fin_timeout = 15
net.ipv4.tcp_keepalive_time = 300
net.ipv4.tcp_keepalive_probes = 5
net.ipv4.tcp_keepalive_intvl = 15
net.ipv4.ip_local_port_range = 1024 65535
net.ipv4.tcp_max_syn_backlog = 2048

# ============================================================================
# OTIMIZAÇÕES DE MEMÓRIA VIRTUAL
# ============================================================================
# Reduz o uso de swap, mantendo mais dados na RAM
vm.swappiness = 10
# Aumenta o limite de memória mapeada
vm.max_map_count = 262144
# Otimização de dirty pages (reduz latência de I/O)
vm.dirty_background_ratio = 5
vm.dirty_ratio = 10
vm.dirty_background_bytes = 0
vm.dirty_bytes = 0
# Flush interval para dirty pages
vm.dirty_writeback_centisecs = 100
vm.dirty_expire_centisecs = 200

# ============================================================================
# OTIMIZAÇÕES DE AGENDAMENTO (CFS Scheduler)
# ============================================================================
# Reduz latência de agendamento (importante para input lag)
kernel.sched_latency_ns = 1000000
kernel.sched_min_granularity_ns = 1000000
kernel.sched_wakeup_granularity_ns = 15000000
kernel.sched_migration_cost_ns = 500000
# Prioridade de tarefas
kernel.sched_child_runs_first = 1

# ============================================================================
# OTIMIZAÇÕES DE FILE SYSTEM
# ============================================================================
# Aumenta o número de file descriptors
fs.file-max = 2097152
fs.nr_open = 2097152
# Aumenta o tamanho do inode cache
fs.inode-max = 1048576

# ============================================================================
# OTIMIZAÇÕES DE KERNEL
# ============================================================================
# Desativa o magic SysRq (segurança)
kernel.sysrq = 0
# Aumenta o tamanho do pipe buffer
fs.pipe-max-size = 1048576
# Otimizações de performance
kernel.perf_event_paranoid = 1

# ============================================================================
# HUGE PAGES (Se disponível)
# ============================================================================
# Transparent Huge Pages - madvise é mais seguro que always
vm.transparent_hugepage = madvise
# Defrag strategy
vm.transparent_hugepage_defrag = defer

# ============================================================================
# OTIMIZAÇÕES DE CACHE
# ============================================================================
# Aumenta o cache de dentries e inodes
fs.dentry-state = 10 6 45 0 0 0
fs.inode-state = 0 0 0 0 0 0

# ============================================================================
# OTIMIZAÇÕES DE NUMA (Se disponível)
# ============================================================================
# Balanceamento de memória em sistemas NUMA
kernel.numa_balancing = 1
